<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Super ChiDog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #5c94fc;
    touch-action: manipulation;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const gravity = 0.9;
const jumpPower = -16;
const runSpeed = 5;
const groundHeight = 80;

// PLAYER
const player = {
  x: 120,
  y: 0,
  w: 42,
  h: 42,
  vy: 0,
  onGround: false,
  rot: 0
};

// PLATFORMS
const platforms = [];
for (let i = 0; i < 7; i++) {
  platforms.push({
    x: i * 260,
    y: canvas.height - groundHeight - 120 - Math.random() * 120,
    w: 220,
    h: 22
  });
}

// INPUT (tap anywhere)
function jump() {
  if (player.onGround) {
    player.vy = jumpPower;
    player.onGround = false;
  }
}
window.addEventListener("touchstart", jump);
window.addEventListener("mousedown", jump);

// UPDATE
function update() {
  player.vy += gravity;
  player.y += player.vy;
  player.onGround = false;

  // ground collision
  const groundY = canvas.height - groundHeight - player.h;
  if (player.y >= groundY) {
    player.y = groundY;
    player.vy = 0;
    player.onGround = true;
  }

  // platforms move + collide
  platforms.forEach(p => {
    p.x -= runSpeed;

    // collision from above
    if (
      player.x + player.w > p.x &&
      player.x < p.x + p.w &&
      player.y + player.h >= p.y &&
      player.y + player.h <= p.y + p.h &&
      player.vy >= 0
    ) {
      player.y = p.y - player.h;
      player.vy = 0;
      player.onGround = true;
    }

    // recycle platform
    if (p.x + p.w < 0) {
      p.x = canvas.width + Math.random() * 300;
      p.y = canvas.height - groundHeight - 120 - Math.random() * 150;
    }
  });

  // rotation while jumping
  if (!player.onGround) {
    player.rot += 0.15;
  } else {
    player.rot = 0;
  }
}

// DRAW
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // sky
  ctx.fillStyle = "#5c94fc";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // ground
  ctx.fillStyle = "#3cb043";
  ctx.fillRect(0, canvas.height - groundHeight, canvas.width, groundHeight);

  // platforms
  ctx.fillStyle = "#8b4513";
  platforms.forEach(p => {
    ctx.fillRect(p.x, p.y, p.w, p.h);
  });

  // player (placeholder dog)
  ctx.save();
  ctx.translate(player.x + player.w/2, player.y + player.h/2);
  ctx.rotate(player.rot);
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(0, 0, player.w/2, 0, Math.PI * 2);
  ctx.fill();
  ctx.restore();
}

// LOOP
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
